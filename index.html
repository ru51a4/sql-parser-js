<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>sql</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
        .alias {
            color: blue;
            font-weight: bold;
        }

        .operator {
            color: red;
        }
    </style>
    <script src='index.js'></script>
</head>

<body>
    <div class="container">

        <div class="row mt-5">
            <div class="col-6">
                <textarea id="sql" class="form-control" rows="20" aria-label="scss">
( SELECT a.id, gg.id FROM gg.diaries a JOIN gg.table gg ON a.id = gg.di JOIN ( SELECT * FROM nested_table nt JOIN ( SELECT * FROM nested_table2 nt2 ) ntt2 on ntt2.id = 1337 ) asd on asd.id = gg.id WHERE 1 = 1
OR gg.id = 1337 GROUP BY asd DESC )
 
            </textarea>
            </div>
            <div class="main col-6">
            </div>
        </div>
        <div class="row mt-5">
            <div class="col-12 d-flex justify-content-center">
                <button type="button" class="btn btn-primary">click</button>
            </div>
        </div>
    </div>
</body>
<script>
    let sql = document.querySelector('#sql');
    let main = document.querySelector('.main');

    document.querySelector("button").addEventListener('click', () => {
        let obj = getObject(sql.value);

        let getHtml = (obj) => {
            let html = "<br>";
            console.log({ obj })
            html += '<span class="operator">SELECT </span>';
            console.log({ 'aa': obj.columns })
            html += (!obj.columns.length) ? '' : obj.columns.reduce((acc, c) => acc + `<span>${c}</span><span>, </span>`, '');
            html += `<span class="operator"><br> FROM </span>`;
            html += `<span>${obj.fromSources[0].table}</span>  <span class="alias">${obj.fromSources[0].alias} </span>`
            html += (!obj.joins.length) ? '' : obj.joins.reduce((acc, c) => {
                if (typeof c.table === 'object') {
                    return acc + '<span class="operator"><br>JOIN </span> ( ' + getHtml(c.table) + ' ) ' + `<span class="alias">${c.alias}</span> ` + c.exp.reduce((acc, c) => {
                        return acc + `<span  class="operator">${c.ttype}</span> <span>${c.left}</span> <span>${c.type}</span> <span>${c.right}</span>`
                    }, '')
                }
                return acc + `<span class="operator"><br>JOIN</span> <span>${c.table}</span> <span class="alias">${c.alias}</span> 
                        ${c.exp.reduce((acc, c) => {
                    return acc + `<span  class="operator">${c.ttype}</span> <span>${c.left}</span> <span>${c.type}</span> <span>${c.right}</span>`
                }, '')}`
            }, '');
            html += (!obj.whereClauses.length) ? '' : `<span  class="operator"><br>WHERE</span>`;
            html += (!obj.whereClauses.length) ? '' : obj.whereClauses.reduce((acc, c) => acc + `<span> ${c.left}</span> <span>${c.type}</span> <span>${c.right}</span> <span>${c.next ?? ''}</span>  `, '');
            html += (!obj.groupByColumns.length) ? '' : `<span class="operator"><br>GROUP BY</span>`;
            html += obj.groupByColumns.reduce((acc, c) => acc + `<span> ${c.col}</span> <span>${c.type}</span>`, '');
            html += `</div>`
            return html
        }
        main.innerHTML = getHtml(obj[0])
    }, false);
</script>

</html>